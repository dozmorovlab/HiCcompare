<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>HiCcompare: Joint normalization and comparative analysis of multiple Hi-C datasets • HiCcompare</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="bootstrap-toc.css">
<script src="bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="pkgdown.css" rel="stylesheet">
<script src="pkgdown.js"></script><meta property="og:title" content="HiCcompare: Joint normalization and comparative analysis of multiple Hi-C datasets">
<meta property="og:description" content="HiCcompare provides functions for joint normalization and difference detection in multiple Hi-C datasets. 
    HiCcompare operates on processed Hi-C data in the form of chromosome-specific chromatin interaction matrices. 
    It accepts three-column tab-separated text files storing chromatin interaction matrices in a sparse matrix format 
    which are available from several sources. HiCcompare is designed to give the user the ability to perform a comparative
    analysis on the 3-Dimensional structure of the genomes of cells in different biological states.`HiCcompare` differs 
    from other packages that attempt to compare Hi-C data in that it works on processed data in chromatin interaction 
    matrix format instead of pre-processed sequencing data. In addition, `HiCcompare` provides a non-parametric method 
    for the joint normalization and removal of biases between two Hi-C datasets for the purpose of comparative analysis. 
    `HiCcompare` also provides a simple yet robust method for detecting differences between Hi-C datasets. ">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-home">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="index.html">HiCcompare</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.11.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="articles/HiCcompare-vignette.html">HiCcompare Usage Vignette</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/dozmorovlab/HiCcompare/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="contents col-md-9">
<div id="hiccompare" class="section level1">
<div class="page-header"><h1 class="hasAnchor">
<a href="#hiccompare" class="anchor"></a><a href="https://dozmorovlab.github.io/HiCcompare/">HiCcompare</a>
</h1></div>
<div id="overview" class="section level2">
<h2 class="hasAnchor">
<a href="#overview" class="anchor"></a>Overview</h2>
<p><code>HiCcompare</code> provides functions for joint normalization and difference detection in multiple Hi-C datasets. <code>HiCcompare</code> operates on processed Hi-C data in the form of chromosome-specific chromatin interaction matrices. <a href="https://bioconductor.org/packages/HiCcompare/">HiCcompare is available on Bioconductor</a>.</p>
<p>If you have more than two Hi-C datasets, please see our other package, <a href="https://bioconductor.org/packages/multiHiCcompare/">multiHiCcompare</a>.</p>
<p><code>HiCcompare</code> accepts three-column tab-separated text files storing chromatin interaction matrices in a sparse matrix format which are available from several sources such as the <a href="http://aidenlab.org/data.html">Aiden Lab</a> (<code>.hic</code> files) and the <a href="http://cooler.readthedocs.io/en/latest/index.html">Mirnylab FTP site</a> (<code>.cool</code> files). <code>HiCcompare</code> performs differential chromatin interaction analysis between two biological conditions.</p>
<p>First, <code>HiCcompare</code> jointly normalizes two Hi-C datasets to remove biases between them. Then, it can detect significant differences between the datasets using a genomic distance-stratified permutation test. The novel concept of the MD plot, based on the commonly used MA plot or Bland-Altman plot, is the basis for these methods. The log <strong>M</strong>inus (difference) between chromatin interaction frequencies is plotted on the Y-axis. The genomic <strong>D</strong>istance is plotted on the X-axis. The MD plot allows for visualization, normalization, and comparing the differences between the Hi-C datasets in a distance-stratified manner.</p>
<p>The main functions are:</p>
<ul>
<li>
<code><a href="reference/hic_loess.html">hic_loess()</a></code> - performs joint <code>loess</code> normalization, minimizing global and local biases between Hi-C datasets</li>
<li>
<code><a href="reference/hic_compare.html">hic_compare()</a></code> - performs the difference detection process to detect significant changes between Hi-C datasets and assist in comparative analysis</li>
</ul>
<p>Several demo Hi-C datasets are also included in the package. Refer to the <code>HiCcompare</code> vignette for full usage instructions, <code><a href="articles/HiCcompare-vignette.html">vignette("HiCcompare-vignette")</a></code></p>
</div>
<div id="installation" class="section level2">
<h2 class="hasAnchor">
<a href="#installation" class="anchor"></a>Installation</h2>
<p>First, make sure you have all dependencies installed in R.</p>
<div class="sourceCode" id="cb1"><pre class="downlit">
<span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html">install.packages</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">'dplyr'</span>, <span class="st">'data.table'</span>, <span class="st">'ggplot2'</span>, <span class="st">'gridExtra'</span>, 
                   <span class="st">'mgcv'</span>, <span class="st">'parallel'</span>, <span class="st">'devtools'</span>))

<span class="co">if</span> (<span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/ns-load.html">requireNamespace</a></span>(<span class="st">"BiocManager"</span>, quietly=<span class="fl">TRUE</span>))
    <span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html">install.packages</a></span>(<span class="st">"BiocManager"</span>)
<span class="kw">BiocManager</span>::<span class="fu"><a href="https://rdrr.io/pkg/BiocManager/man/install.html">install</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"InteractionSet"</span>, <span class="st">"GenomicRanges"</span>, <span class="st">"IRanges"</span>, 
           <span class="st">"BiocParallel"</span>, <span class="st">"QDNAseq"</span>, <span class="st">"GenomeInfoDbData"</span>))             
</pre></div>
<p>To install <code>HiCcompare</code> from Bioconductor, use the following commands.</p>
<div class="sourceCode" id="cb2"><pre class="downlit">
<span class="co"># Bioconductor development version and GitHub Release contain major changes for difference detection</span>
<span class="co"># it is recommended to use the GitHub release until the next Bioconductor update</span>
<span class="co">if</span> (<span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/ns-load.html">requireNamespace</a></span>(<span class="st">"BiocManager"</span>, quietly=<span class="fl">TRUE</span>))
    <span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html">install.packages</a></span>(<span class="st">"BiocManager"</span>)
<span class="kw">BiocManager</span>::<span class="fu"><a href="https://rdrr.io/pkg/BiocManager/man/install.html">install</a></span>(<span class="st">"HiCcompare"</span>)
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="kw">HiCcompare</span>)
</pre></div>
<p>Or, install the latest version of <code>HiCcompare</code> directly from the GitHub.</p>
<div class="sourceCode" id="cb3"><pre class="downlit">
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="kw"><a href="https://devtools.r-lib.org">devtools</a></span>)
<span class="fu"><a href="https://devtools.r-lib.org//reference/remote-reexports.html">install_github</a></span>(<span class="st">'dozmorovlab/HiCcompare'</span>, build_vignettes = <span class="fl">TRUE</span>)
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="kw">HiCcompare</span>)
</pre></div>
</div>
<div id="usage" class="section level2">
<h2 class="hasAnchor">
<a href="#usage" class="anchor"></a>Usage</h2>
<p>First, you will need to obtain some Hi-C data. Data is available from the sources listed in the overview, along with many others. You will need to extract the data and read it into R as either a 3 column sparse upper triangular matrix or a 7-column BEDPE file. For more details on data extraction, see the <code>HiCcompare</code>’s vignette.</p>
<p>Below is an example analysis using <code>HiCcompare</code>. The data in 3-column sparse upper triangular matrix format is loaded, and the first step is to create a <code>hic.table</code> object using the <code><a href="reference/create.hic.table.html">create.hic.table()</a></code> function. Next, the two Hi-C matrices are jointly normalized using the <code><a href="reference/hic_loess.html">hic_loess()</a></code> function. Finally, difference detection can be performed using the <code><a href="reference/hic_compare.html">hic_compare()</a></code> function. The <code><a href="reference/hic_loess.html">hic_loess()</a></code> and <code><a href="reference/hic_compare.html">hic_compare()</a></code> functions will also produce an MD plot for visualizing the differences between the datasets.</p>
<div class="sourceCode" id="cb4"><pre class="downlit">
<span class="co"># load data</span>
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="kw">HiCcompare</span>)
<span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span>(<span class="st">"HMEC.chr22"</span>)
<span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span>(<span class="st">"NHEK.chr22"</span>)

<span class="co"># create the `hic.table` object</span>
<span class="kw">chr22.table</span> <span class="op">=</span> <span class="fu"><a href="reference/create.hic.table.html">create.hic.table</a></span>(<span class="kw">HMEC.chr22</span>, <span class="kw">NHEK.chr22</span>, chr = <span class="st">'chr22'</span>)
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span>(<span class="kw">chr22.table</span>)

<span class="co"># Jointly normalize data for a single chromosome</span>
<span class="kw">hic.table</span> <span class="op">=</span> <span class="fu"><a href="reference/hic_loess.html">hic_loess</a></span>(<span class="kw">chr22.table</span>, Plot = <span class="fl">TRUE</span>)
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span>(<span class="kw">hic.table</span>)

<span class="co"># input hic.table object into hic_compare</span>
<span class="kw">hic.table</span> <span class="op">=</span> <span class="fu"><a href="reference/hic_compare.html">hic_compare</a></span>(<span class="kw">hic.table</span>, Plot = <span class="fl">TRUE</span>)
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span>(<span class="kw">hic.table</span>)
</pre></div>
</div>
<div id="citations" class="section level2">
<h2 class="hasAnchor">
<a href="#citations" class="anchor"></a>Citations</h2>
<p>Stansfield, John C., Kellen G. Cresswell, Vladimir I. Vladimirov, and Mikhail G. Dozmorov. <a href="https://doi.org/10.1186/s12859-018-2288-x">HiCcompare: An R-Package for Joint Normalization and Comparison of HI-C Datasets</a>. <em>BMC Bioinformatics</em> 19, no. 1 (December 2018).</p>
<p>Stansfield, John C., Duc Tran, Tin Nguyen, and Mikhail G. Dozmorov. <a href="https://doi.org/10.1002/cpbi.76">R Tutorial: Detection of Differentially Interacting Chromatin Regions From Multiple Hi-C Datasets</a>. Current Protocols in Bioinformatics, May 2019</p>
<p><a href="https://github.com/mdozmorov/HiCcompareWorkshop">HiCcompareWorkshop</a> - “Detection of Differentially Interacting Chromatin Regions From Multiple Hi-C Datasets” workshop presented on Bioconductor 2020 conference</p>
</div>
<div id="additional-vignettes" class="section level2">
<h2 class="hasAnchor">
<a href="#additional-vignettes" class="anchor"></a>Additional Vignettes</h2>
<p>The <code>HiCcompare</code> paper included several supplemental files that showcase some of the methods’ usage and reasoning. Below are the titles and brief descriptions of each of these vignettes along with links to the compiled <code>.pdf</code> and the source <code>.Rmd</code> files.</p>
<p><a href="https://github.com/dozmorovlab/HiCcompare/raw/supplemental/supplemental_files/S1_File.pdf">Normalization method comparison</a> - Comparison of several Hi-C normalization techniques to display the persistence of bias in individually normalized chromatin interaction matrices, and its effect on the detection of differential chromatin interactions. <a href="https://github.com/dozmorovlab/HiCcompare/raw/supplemental/supplemental_files/S1_File.Rmd">Source</a></p>
<p><a href="https://github.com/dozmorovlab/HiCcompare/raw/supplemental/supplemental_files/S2_File.pdf">Estimation of the IF power-law depencence</a> - Estimation of the power-law dependence between the <span class="math inline"><em>l</em><em>o</em><em>g</em><sub>10</sub> − <em>l</em><em>o</em><em>g</em><sub>10</sub></span> interaction frequencies and distance between interacting regions. This vignette displays the reasoning behind using a power-law function to simulate the signal portion of Hi-C matrices. <a href="https://github.com/dozmorovlab/HiCcompare/raw/supplemental/supplemental_files/S2_File.Rmd">Source</a></p>
<p><a href="https://github.com/dozmorovlab/HiCcompare/raw/supplemental/supplemental_files/S3_File.pdf">Estimation of the SD power-law dependence</a> - Estimation of the power-law dependence between the <span class="math inline"><em>l</em><em>o</em><em>g</em><sub>10</sub> − <em>l</em><em>o</em><em>g</em><sub>10</sub></span> SD of interaction frequencies and distance between interacting regions. This vignette displays the reasoning behind using a power-law function to simulate the noise component of Hi-C matrices. <a href="https://github.com/dozmorovlab/HiCcompare/raw/supplemental/supplemental_files/S3_File.Rmd">Source</a></p>
<p><a href="https://github.com/dozmorovlab/HiCcompare/raw/supplemental/supplemental_files/S4_File.pdf">Estimation of proportion of zeros</a> - Estimation of the dependence between the proportion of zeros and distance between interacting regions. This vignette shows the distribution of zeros in real Hi-C data. The results were used for modeling the proportion of zeros in simulated Hi-C matrices with a linear function. <a href="https://github.com/dozmorovlab/HiCcompare/raw/supplemental/supplemental_files/S4_File.Rmd">Source</a></p>
<p><a href="https://github.com/dozmorovlab/HiCcompare/raw/supplemental/supplemental_files/S5_File.pdf">Evaluation of difference detection in simulated data</a> - Extended evaluation of differential chromatin interaction detection analysis using simulated Hi-C data. Many different classifier performance measures are presented. Note: if trying to compile the source <code>.Rmd</code> this will take a long time to knit. <a href="https://github.com/dozmorovlab/HiCcompare/raw/supplemental/supplemental_files/S5_File.Rmd">Source</a></p>
<p><a href="https://github.com/dozmorovlab/HiCcompare/raw/supplemental/supplemental_files/S6_File.pdf">Evaluation of difference detection in real data</a> - Extended evaluation of differential chromatin interaction detection analysis using real Hi-C data. Many different classifier performance measures are presented. Note: if trying to compile the source <code>.Rmd</code> this will take a long time to knit. <a href="https://github.com/dozmorovlab/HiCcompare/raw/supplemental/supplemental_files/S6_File.Rmd">Source</a></p>
<p><a href="https://github.com/dozmorovlab/HiCcompare/raw/supplemental/supplemental_files/S7_File.pdf">loess at varying resolution</a> - Visualization of the <code>loess</code> joint normalization over varying resolutions. This vignette shows that increasing sparsity of Hi-C matrices with increasing resolution causes loess to become less useful for normalization at high resolutions. <a href="https://github.com/dozmorovlab/HiCcompare/raw/supplemental/supplemental_files/S7_File.Rmd">Source</a></p>
</div>
<div id="contributions--support" class="section level2">
<h2 class="hasAnchor">
<a href="#contributions--support" class="anchor"></a>Contributions &amp; Support</h2>
<p>Suggestions for new features and bug reports are welcome. Please create a new <a href="https://github.com/dozmorovlab/HiCcompare/issues">issue</a> for any of these or contact the author directly: <a href="https://github.com/jstansfield0">@jstansfield0</a> (<a href="mailto:stansfieldjc@vcu.edu" class="email">stansfieldjc@vcu.edu</a>)</p>
</div>
<div id="contributors" class="section level2">
<h2 class="hasAnchor">
<a href="#contributors" class="anchor"></a>Contributors</h2>
<p>Authors: <a href="https://github.com/jstansfield0">@jstansfield0</a> (<a href="mailto:stansfieldjc@vcu.edu" class="email">stansfieldjc@vcu.edu</a>) &amp; <a href="https://github.com/mdozmorov">@mdozmorov</a> (<a href="mailto:mikhail.dozmorov@vcuhealth.org" class="email">mikhail.dozmorov@vcuhealth.org</a>)</p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <div class="links">
<h2>Links</h2>
<ul class="list-unstyled">
<li>Download from BIOC at <br><a href="https://www.bioconductor.org/packages/HiCcompare">https://​www.bioconductor.org/​packages/​HiCcompare</a>
</li>
<li>Browse source code at <br><a href="https://github.com/dozmorovlab/HiCcompare/">https://​github.com/​dozmorovlab/​HiCcompare/​</a>
</li>
<li>Report a bug at <br><a href="https://github.com/dozmorovlab/HiCcompare/issues">https://​github.com/​dozmorovlab/​HiCcompare/​issues</a>
</li>
</ul>
</div>
<div class="license">
<h2>License</h2>
<ul class="list-unstyled">
<li>
<a href="https://opensource.org/licenses/mit-license.php">MIT</a> + file <a href="LICENSE-text.html">LICENSE</a>
</li>
</ul>
</div>
<div class="citation">
<h2>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html">Citing HiCcompare</a></li>
</ul>
</div>
<div class="developers">
<h2>Developers</h2>
<ul class="list-unstyled">
<li>John Stansfield <br><small class="roles"> Maintainer </small>  </li>
<li><a href="authors.html">All authors...</a></li>
</ul>
</div>

  </div>
</div>


      <footer><div class="copyright">
  <p>Developed by John Stansfield.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.9000.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
