<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Create hic.table object from a sparse upper triangular Hi-C matrix — create.hic.table • HiCcompare</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Create hic.table object from a sparse upper triangular Hi-C matrix — create.hic.table" />
<meta property="og:description" content="Create hic.table object from a sparse upper triangular Hi-C matrix" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">HiCcompare</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.11.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/HiCcompare-vignette.html">HiCcompare Usage Vignette</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/dozmorovlab/HiCcompare/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Create hic.table object from a sparse upper triangular Hi-C matrix</h1>
    <small class="dont-index">Source: <a href='https://github.com/dozmorovlab/HiCcompare/blob/master/R/create_hic_table.R'><code>R/create_hic_table.R</code></a></small>
    <div class="hidden name"><code>create.hic.table.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Create hic.table object from a sparse upper triangular Hi-C matrix</p>
    </div>

    <pre class="usage"><span class='fu'><a href='https://rdrr.io/pkg/HiCcompare/man/create.hic.table.html'>create.hic.table</a></span>(
  <span class='kw'>sparse.mat1</span>,
  <span class='kw'>sparse.mat2</span>,
  chr = <span class='fl'>NA</span>,
  scale = <span class='fl'>TRUE</span>,
  include.zeros = <span class='fl'>FALSE</span>,
  subset.dist = <span class='fl'>NA</span>,
  subset.index = <span class='fl'>NA</span>,
  exclude.regions = <span class='fl'>NA</span>,
  exclude.overlap = <span class='fl'>0.2</span>
)</pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>sparse.mat1</th>
      <td><p>Required, sparse upper triangular Hi-C matrix, 7 column
BEDPE format of the upper triangle of the matrix, OR InteractionSet
object with the genomic ranges of the interacting regions for the upper
triangle of the Hi-C matrix and a single metadata column containing the
interaction frequencies for each interacting pair for the first dataset
you wish to jointly normalize.</p></td>
    </tr>
    <tr>
      <th>sparse.mat2</th>
      <td><p>Required, sparse upper triangular Hi-C matrix, 7 column
BEDPE format of the upper triangle of the matrix, OR InteractionSet
object with the genomic ranges of the interacting regions for the upper
triangle of the Hi-C matrix and a single metadata column containing the
interaction frequencies for each interacting pair for the second dataset
you wish to jointly normalize.</p></td>
    </tr>
    <tr>
      <th>chr</th>
      <td><p>The chromosome name for the matrices being entered i.e 'chr1' or
'chrX'. Only needed if using sparse upper triangular matrix format.
If using BEDPE format leave set to NA.</p></td>
    </tr>
    <tr>
      <th>scale</th>
      <td><p>Logical, should scaling be applied to the matrices to adjust
for total read counts. If TRUE the IFs of the second sparse
matrix will be adjusted as follows: IF2_scaled = IF2 / (sum(IF2)/sum(IF1)).</p></td>
    </tr>
    <tr>
      <th>include.zeros</th>
      <td><p>Logical, If set to TRUE the function will include pairwise
interactions where one of the interaction frequencies is 0.</p></td>
    </tr>
    <tr>
      <th>subset.dist</th>
      <td><p>Should the matrix be subset to only include interactions up
to a user specified matrix unit distance? i.e. to only include
the cells of the matrix which are at a unit distance less than or equal to
100 set <code>subset.dist = 100</code>. Subsetting the matrix by distance
will cut out any interactions occuring at a unit distance greater than the
specified value. This could be used to speed up computation time or if
there is only interest in the interactions occuring below a specific
distance in the matrix. Warning: If you subset by distance do NOT to
transform the subsetted hic.table into a full matrix using `sparse2full`.
If you plan on trasforming the matrix to a full contact matrix
use subset.index instead.</p></td>
    </tr>
    <tr>
      <th>subset.index</th>
      <td><p>Should the matrix be subset by a user specified distance?
Input as a vector of 4 numbers (i.start, i.end, j.start, j.end).
i.e. to only include a subset of the matrix with row numbers 20 &lt;= i &lt;= 40
and column numbers 30 &lt;= j &lt;= 50 set as <code>subset.index = c(20, 40, 30, 50)</code>.
This can be used to speed up computation time if only a subset of the matrix is
of interest. The indices used here correspond to the indices of the full
Hi-C contact matrix. The `sparse2full` function can be used to view the full
contact matrix and make a decision about subsetting based on index.</p></td>
    </tr>
    <tr>
      <th>exclude.regions</th>
      <td><p>A data.frame or genomic ranges object in the form of
chr start end. Regions contained in the object will be removed from
the hic.table object. Could be useful for excluding regions with a
known CNV, blacklist regions, or some other a priori known difference.</p></td>
    </tr>
    <tr>
      <th>exclude.overlap</th>
      <td><p>The proportion of overlap required to exclude a region.
Defaults to 0.2, indicating 20% or more overlap will be enough for
exclusion. To exclude any amount of overlap set to 0.
If set to 1, only a 100% overlap with an excluded regions will
result in exclusion.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>A hic.table object.</p>
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>This function is used to transform two sparse upper triangular Hi-C matrices
   into an object usable in the <code>hic_loess</code> function.
   Sparse upper triangular Hi-C matrix format is typical of the Hi-C data available
   from the Aiden Lab <a href='http://www.aidenlab.org/'>http://www.aidenlab.org/</a>. If you have a full
   Hi-C contact matrix, first transform it to sparse upper triangular format using
   the <code>full2sparse</code> function. Sparse matrices should have 3 columns
   in the following order: Start location of region 1, Start location of region 2,
   Interaction Frequency. Matrices in 7 column BEDPE format should
   have 7 columns in the following order: Chromosome name of the first region,
   Start location of first region, End location of first region,
   Chromosome name of the second region, Start location of the second region,
   End location of the second region, Interaction Frequency. Please enter either
   two sparse matrices or two matrices in 7 column BEDPE format or two
   InteractionSet objects; do not mix and match.</p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='co'># Create hic.table object using included Hi-C data in sparse upper</span>
<span class='co'># triangular matrix format</span>
<span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span>(<span class='st'>'HMEC.chr22'</span>)
<span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span>(<span class='st'>'NHEK.chr22'</span>)
<span class='kw'>hic.table</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/HiCcompare/man/create.hic.table.html'>create.hic.table</a></span>(<span class='kw'>HMEC.chr22</span>, <span class='kw'>NHEK.chr22</span>, chr = <span class='st'>'chr22'</span>)
<span class='co'># View result</span>
<span class='kw'>hic.table</span></div><div class='output co'>#&gt;        chr1   start1     end1  chr2   start2     end2  IF1         IF2 D
#&gt;    1: chr22 16000000 16500000 chr22 16000000 16500000    5    5.203323 0
#&gt;    2: chr22 16000000 16500000 chr22 16500000 17000000    2    8.672206 1
#&gt;    3: chr22 16500000 17000000 chr22 16500000 17000000  297  480.440193 0
#&gt;    4: chr22 16000000 16500000 chr22 17000000 17500000    5   14.742750 2
#&gt;    5: chr22 16500000 17000000 chr22 17000000 17500000   92  277.510581 1
#&gt;   ---                                                                   
#&gt; 2479: chr22 49000000 49500000 chr22 51000000 51500000   21   54.634896 4
#&gt; 2480: chr22 49500000 50000000 chr22 51000000 51500000   35   71.112086 3
#&gt; 2481: chr22 50000000 50500000 chr22 51000000 51500000  394  339.083241 2
#&gt; 2482: chr22 50500000 51000000 chr22 51000000 51500000 4066 2741.284207 1
#&gt; 2483: chr22 51000000 51500000 chr22 51000000 51500000 9916 7132.021930 0
#&gt;                 M
#&gt;    1:  0.05750528
#&gt;    2:  2.11639897
#&gt;    3:  0.69389392
#&gt;    4:  1.56000562
#&gt;    5:  1.59283701
#&gt;   ---            
#&gt; 2479:  1.37943338
#&gt; 2480:  1.02273986
#&gt; 2481: -0.21655615
#&gt; 2482: -0.56875831
#&gt; 2483: -0.47544713</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by John Stansfield.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.9000.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


