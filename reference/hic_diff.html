<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Detect differences between two jointly normalized Hi-C datasets. OLD METHOD; USE hic_compare() instead — hic_diff • HiCcompare</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Detect differences between two jointly normalized Hi-C datasets. OLD METHOD; USE hic_compare() instead — hic_diff" />
<meta property="og:description" content="Detect differences between two jointly normalized Hi-C datasets. OLD METHOD; USE hic_compare() instead" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">HiCcompare</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.11.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/HiCcompare-vignette.html">HiCcompare Usage Vignette</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/dozmorovlab/HiCcompare/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Detect differences between two jointly normalized Hi-C datasets. OLD METHOD; USE hic_compare() instead</h1>
    <small class="dont-index">Source: <a href='https://github.com/dozmorovlab/HiCcompare/blob/master/R/hic_diff.R'><code>R/hic_diff.R</code></a></small>
    <div class="hidden name"><code>hic_diff.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Detect differences between two jointly normalized Hi-C datasets. OLD METHOD; USE hic_compare() instead</p>
    </div>

    <pre class="usage"><span class='fu'><a href='https://rdrr.io/pkg/HiCcompare/man/hic_diff.html'>hic_diff</a></span>(
  <span class='kw'>hic.table</span>,
  diff.thresh = <span class='st'>"auto"</span>,
  iterations = <span class='fl'>10000</span>,
  Plot = <span class='fl'>FALSE</span>,
  Plot.smooth = <span class='fl'>TRUE</span>,
  parallel = <span class='fl'>FALSE</span>,
  BP_param = <span class='fu'>bpparam</span>()
)</pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>hic.table</th>
      <td><p>A hic.table or list of hic.tables output from the
<code>hic_loess</code> function. hic.table must be jointly normalized
before being entered.</p></td>
    </tr>
    <tr>
      <th>diff.thresh</th>
      <td><p>Fold change threshold desired to call a detected
difference significant. Set to 'auto' by default to indicate that the
difference threshold will be automatically calculated as 2 standard
deviations of all the adjusted M values. For no p-value adjustment
set diff.thresh = NA. To set your own threshold enter a numeric value
i.e. diff.thresh = 1. If set to 'auto' or a numeric value, a check will
be made as follows: if permutation p-value &lt; 0.05 AND M &lt; diff.thresh (the log2
fold change for the difference between IF1 and IF2) then
the p-value will be set to 0.5.</p></td>
    </tr>
    <tr>
      <th>iterations</th>
      <td><p>Number of iterations for the permuation test.</p></td>
    </tr>
    <tr>
      <th>Plot</th>
      <td><p>Logical, should the MD plot showing before/after loess normalization
be output?</p></td>
    </tr>
    <tr>
      <th>Plot.smooth</th>
      <td><p>Logical, defaults to TRUE indicating the MD plot
will be a smooth scatter plot. Set to FALSE for a scatter plot
with discrete points.</p></td>
    </tr>
    <tr>
      <th>parallel</th>
      <td><p>Logical, set to TRUE to utilize the <code>parallel</code> package's
parallelized computing. Only works on unix operating systems. Only useful if
entering a list of hic.tables.</p></td>
    </tr>
    <tr>
      <th>BP_param</th>
      <td><p>Parameters for BiocParallel. Defaults to bpparam(), see help
for BiocParallel for more information
<a href='http://bioconductor.org/packages/release/bioc/vignettes/BiocParallel/inst/doc/Introduction_To_BiocParallel.pdf'>http://bioconductor.org/packages/release/bioc/vignettes/BiocParallel/inst/doc/Introduction_To_BiocParallel.pdf</a></p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>A hic.table with additional columns containing a p-value for the significance
    of the difference and the raw fold change between the IFs of the two datasets.</p>
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>This is the old method for detecting difference. The function is left in for 
    legacy reasons and 
    it is recommended to use the new function, hic_compare(), instead.
    The function takes in a hic.table or a list of hic.table objects created
    with the <code>hic_loess</code> function. If you wish to perform difference
    detection on Hi-C data for multiple chromosomes use a list of hic.tables. The process
    can be parallelized using the <code>parallel</code>
    setting. The adjusted IF and adjusted M calculated from <code>hic_loess</code> are used for
    difference detection. A permutation test is performed to test
    the significance of the difference between each IF of the two datasets. Permutations
    are broken in blocks for each unit distance. See methods section
    of Stansfield &amp; Dozmorov 2017 for more details.</p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='co'># Create hic.table object using included Hi-C data in sparse upper triangular</span>
<span class='co'># matrix format</span>
<span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span>(<span class='st'>'HMEC.chr22'</span>)
<span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span>(<span class='st'>'NHEK.chr22'</span>)
<span class='kw'>hic.table</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/HiCcompare/man/create.hic.table.html'>create.hic.table</a></span>(<span class='kw'>HMEC.chr22</span>, <span class='kw'>NHEK.chr22</span>, chr = <span class='st'>'chr22'</span>)
<span class='co'># Plug hic.table into hic_loess()</span>
<span class='kw'>result</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/HiCcompare/man/hic_loess.html'>hic_loess</a></span>(<span class='kw'>hic.table</span>, Plot = <span class='fl'>TRUE</span>)</div><div class='output co'>#&gt; <span class='message'>Span for loess: 0.219052588777294</span></div><div class='output co'>#&gt; <span class='message'>GCV for loess: 0.000118686898199309</span></div><div class='output co'>#&gt; <span class='message'>AIC for loess: -0.212037314500057</span></div><div class='img'><img src='hic_diff-1.png' alt='' width='700' height='433' /></div><div class='input'><span class='co'># perform difference detection</span>
<span class='kw'>diff.result</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/HiCcompare/man/hic_diff.html'>hic_diff</a></span>(<span class='kw'>result</span>, diff.thresh = <span class='st'>'auto'</span>, Plot = <span class='fl'>TRUE</span>)</div><div class='img'><img src='hic_diff-2.png' alt='' width='700' height='433' /></div><div class='input'></div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by John Stansfield.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.9000.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


