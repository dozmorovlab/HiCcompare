<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Perform joint loess normalization on two Hi-C datasets — hic_loess • HiCcompare</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Perform joint loess normalization on two Hi-C datasets — hic_loess" />
<meta property="og:description" content="Perform joint loess normalization on two Hi-C datasets" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">HiCcompare</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.11.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/HiCcompare-vignette.html">HiCcompare Usage Vignette</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/dozmorovlab/HiCcompare/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Perform joint loess normalization on two Hi-C datasets</h1>
    <small class="dont-index">Source: <a href='https://github.com/dozmorovlab/HiCcompare/blob/master/R/hic_loess.R'><code>R/hic_loess.R</code></a></small>
    <div class="hidden name"><code>hic_loess.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Perform joint loess normalization on two Hi-C datasets</p>
    </div>

    <pre class="usage"><span class='fu'><a href='https://rdrr.io/pkg/HiCcompare/man/hic_loess.html'>hic_loess</a></span>(
  <span class='kw'>hic.table</span>,
  degree = <span class='fl'>1</span>,
  span = <span class='fl'>NA</span>,
  loess.criterion = <span class='st'>"gcv"</span>,
  Plot = <span class='fl'>FALSE</span>,
  Plot.smooth = <span class='fl'>TRUE</span>,
  parallel = <span class='fl'>FALSE</span>,
  BP_param = <span class='fu'>bpparam</span>()
)</pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>hic.table</th>
      <td><p>hic.table or a list of hic.tables generated from
 the create.hic.table function.
 list of hic.tables generated from the create.hic.table function.
 If you want to perform
normalization over multiple chromosomes from each cell line at
once utilizing parallel computing enter a list of hic.tables and
set parallel = TRUE.</p></td>
    </tr>
    <tr>
      <th>degree</th>
      <td><p>Degree of polynomial to be used for loess. Options
are 0, 1, 2. The default setting is degree = 1.</p></td>
    </tr>
    <tr>
      <th>span</th>
      <td><p>User set span for loess. If set to NA, the span will
be selected automatically using the setting of loess.criterion.
Defaults to NA so that
automatic span selection is performed.
If you know the span, setting it manually will significantly speed
up computational time.</p></td>
    </tr>
    <tr>
      <th>loess.criterion</th>
      <td><p>Automatic span selection criterion. Can use either
'gcv' for generalized cross-validation or 'aicc' for Akaike Information
 Criterion.
 Span selection uses a slightly modified version of the <code>loess.as()</code>
 function from the <code>fANCOVA</code> package. Defaults to 'gcv'.</p></td>
    </tr>
    <tr>
      <th>Plot</th>
      <td><p>Logical, should the MD plot showing before/after loess
normalization be output? Defaults to FALSE.</p></td>
    </tr>
    <tr>
      <th>Plot.smooth</th>
      <td><p>Logical, defaults to TRUE indicating the MD plot
will be a smooth scatter plot. Set to FALSE for a scatter plot
with discrete points.</p></td>
    </tr>
    <tr>
      <th>parallel</th>
      <td><p>Logical, set to TRUE to utilize the <code>parallel</code> package's
parallelized computing. Only works on unix operating systems. Only useful if
entering a list of hic.tables. Defauts to FALSE.</p></td>
    </tr>
    <tr>
      <th>BP_param</th>
      <td><p>Parameters for BiocParallel. Defaults to bpparam(), see help
for BiocParallel for more information
<a href='http://bioconductor.org/packages/release/bioc/vignettes/BiocParallel/inst/doc/Introduction_To_BiocParallel.pdf'>http://bioconductor.org/packages/release/bioc/vignettes/BiocParallel/inst/doc/Introduction_To_BiocParallel.pdf</a></p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>An updated hic.table is returned with the additional columns of adj.IF1,
   adj.IF2 for the respective normalized IFs, an adj.M column for the
   adjusted M, mc for the loess correction factor, and A for the average
   expression value between adj.IF1 and adj.IF2.</p>
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>The function takes in a hic.table or a list of hic.table objects created
    with the <code>create.hic.loess</code> function. If you wish to perform joint
    normalization on Hi-C data for multiple chromosomes use a list of hic.tables.
    The process can be parallelized using the <code>parallel</code>
    setting. The data is fist transformed into what is termed an MD plot (similar
    to the MA plot/Bland-Altman plot). M is the log difference log2(x/y) between
    the two datasets. D is the unit distance in the contact matrix. The MD plot can
    be visualized with the <code>Plot</code> option. Loess regression is then
    performed on the MD plot to model any biases between the two Hi-C datasets. An
    adjusted IF is then calculated for each dataset along with an adjusted M.
    See methods section of Stansfield &amp; Dozmorov 2017 for more details. Note:
    if you receive the warning "In simpleLoess(y, x, w, span, degree = degree,
    parametric = parametric,  ... :pseudoinverse used..." it should not effect
    your results, however it can be avoided by manually setting the span to
    a larger value using the span option.</p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='co'># Create hic.table object using included Hi-C data in sparse upper</span>
<span class='co'># triangular matrix format</span>
<span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span>(<span class='st'>"HMEC.chr22"</span>)
<span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span>(<span class='st'>"NHEK.chr22"</span>)
<span class='kw'>hic.table</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/HiCcompare/man/create.hic.table.html'>create.hic.table</a></span>(<span class='kw'>HMEC.chr22</span>, <span class='kw'>NHEK.chr22</span>, chr= <span class='st'>'chr22'</span>)
<span class='co'># Plug hic.table into hic_loess()</span>
<span class='kw'>result</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/HiCcompare/man/hic_loess.html'>hic_loess</a></span>(<span class='kw'>hic.table</span>, Plot = <span class='fl'>TRUE</span>)</div><div class='output co'>#&gt; <span class='message'>Span for loess: 0.219052588777294</span></div><div class='output co'>#&gt; <span class='message'>GCV for loess: 0.000118686898199309</span></div><div class='output co'>#&gt; <span class='message'>AIC for loess: -0.212037314500057</span></div><div class='img'><img src='hic_loess-1.png' alt='' width='700' height='433' /></div><div class='input'><span class='co'># View result</span>
<span class='kw'>result</span></div><div class='output co'>#&gt;        chr1   start1     end1  chr2   start2     end2  IF1         IF2 D
#&gt;    1: chr22 16000000 16500000 chr22 16000000 16500000    5    5.203323 0
#&gt;    2: chr22 16000000 16500000 chr22 16500000 17000000    2    8.672206 1
#&gt;    3: chr22 16500000 17000000 chr22 16500000 17000000  297  480.440193 0
#&gt;    4: chr22 16000000 16500000 chr22 17000000 17500000    5   14.742750 2
#&gt;    5: chr22 16500000 17000000 chr22 17000000 17500000   92  277.510581 1
#&gt;   ---                                                                   
#&gt; 2479: chr22 49000000 49500000 chr22 51000000 51500000   21   54.634896 4
#&gt; 2480: chr22 49500000 50000000 chr22 51000000 51500000   35   71.112086 3
#&gt; 2481: chr22 50000000 50500000 chr22 51000000 51500000  394  339.083241 2
#&gt; 2482: chr22 50500000 51000000 chr22 51000000 51500000 4066 2741.284207 1
#&gt; 2483: chr22 51000000 51500000 chr22 51000000 51500000 9916 7132.021930 0
#&gt;                 M      adj.IF1     adj.IF2        adj.M         mc           A
#&gt;    1:  0.05750528     5.103586    5.097713 -0.001661128 0.05916641    5.100650
#&gt;    2:  2.11639897     2.079392    8.341096  2.004074812 0.11232416    5.210244
#&gt;    3:  0.69389392   303.153008  470.688840  0.634727512 0.05916641  386.920924
#&gt;    4:  1.56000562     5.294664   13.922271  1.394783581 0.16522204    9.608468
#&gt;    5:  1.59283701    95.652053  266.915059  1.480512855 0.11232416  181.283556
#&gt;   ---                                                                         
#&gt; 2479:  1.37943338    23.009226   49.864033  1.115787132 0.26364624   36.436630
#&gt; 2480:  1.02273986    37.747769   65.935632  0.804666919 0.21807294   51.841701
#&gt; 2481: -0.21655615   417.219518  320.212241 -0.381778188 0.16522204  368.715880
#&gt; 2482: -0.56875831  4227.404883 2636.620313 -0.681082463 0.11232416 3432.012598
#&gt; 2483: -0.47544713 10121.431725 6987.265377 -0.534613540 0.05916641 8554.348551</div><div class='input'></div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by John Stansfield.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.9000.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


